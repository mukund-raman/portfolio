---
import blogData from "../../content/blog.yaml";
import Layout from "../../layouts/Layout.astro";
import Card from "../../components/Card.astro";
import type { BlogPost } from "../../types";

const allPosts = (blogData || []) as BlogPost[];
const posts = allPosts
    .sort((a: BlogPost, b: BlogPost) => {
        return new Date(b.date).getTime() - new Date(a.date).getTime();
    })
    .map((post: BlogPost) => ({
        ...post,
        link: `/blog/${post.slug}`,
        // Card expects 'purple' color for blog posts
        color: post.color || "purple",
    }));
---

<Layout title="Blog">
    <div class="container mx-auto px-6 pt-40 pb-20">
        <div class="max-w-4xl mb-16">
            <h1 class="text-5xl md:text-6xl font-black text-white mb-4">
                Blog <span class="text-neon-purple">.</span>
            </h1>
            <div class="flex items-center gap-3">
                <div class="w-1 h-6 bg-neon-purple"></div>
                <p class="text-gray-400 text-lg max-w-2xl">
                    Technical tutorials, research summaries, and engineering
                    logs.
                </p>
            </div>
        </div>

        {/* Debug Info */}
        <div class="text-xs text-gray-500 mb-4 hidden">
            Found {posts.length} posts.
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {
                posts.map((post: any) => (
                    <Card
                        title={post.title}
                        subtitle={post.subtitle}
                        date={post.date}
                        description={post.description}
                        tags={post.tags}
                        link={post.link}
                        image={post.image}
                        color={post.color}
                        cardType="blog"
                    />
                ))
            }
        </div>
    </div>

    <!-- Bottom spacing to push footer down -->
    <div class="h-20"></div>

    <footer
        class="py-12 border-t border-white/5 w-full text-center text-gray-500 text-sm bg-black/50 backdrop-blur-sm"
    >
        <p>
            &copy; {new Date().getFullYear()} Mukund. Built with Astro & TailwindCSS.
        </p>
    </footer>
</Layout>
