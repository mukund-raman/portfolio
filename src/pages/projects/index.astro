---
import Layout from "../../layouts/Layout.astro";
import Card from "../../components/Card.astro";

import projectsData from "../../content/projects.yaml";
import type { Project } from "../../types";

const allProjects = (projectsData || []) as Project[];
const projects = allProjects.map((project: Project) => ({
    ...project,
    link: `/projects/${project.slug}`,
    // Ensure we pass the viewLink from frontmatter if it exists
    viewLink: project.viewLink,
}));

console.log("DEBUG: Final Projects Array:", JSON.stringify(projects, null, 2));
---

<Layout title="Projects">
    <div class="max-w-[90%] mx-auto px-6 pt-40 pb-20">
        <div class="max-w-4xl mb-16">
            <h1 class="text-5xl md:text-6xl font-black text-white mb-4">
                Projects <span class="text-neon-gold">.</span>
            </h1>
            <div class="flex items-center gap-3">
                <div class="w-1 h-6 bg-neon-gold"></div>
                <p class="text-gray-400 text-lg max-w-2xl">
                    A collection of my technical work, ranging from <span
                        class="text-white">embedded systems</span
                    > to <span class="text-white">full-stack web apps</span>.
                </p>
            </div>
        </div>

        {/* Debug Info in UI */}
        <div class="text-xs text-gray-500 mb-4 hidden">
            Found {projects.length} projects.
        </div>

        <div
            class="grid grid-cols-1 md:grid-cols-[repeat(auto-fill,minmax(500px,1fr))] gap-8"
        >
            {
                projects.map((project: any) => (
                    <Card
                        title={project.title}
                        subtitle={project.subtitle}
                        description={project.description}
                        tags={project.tags}
                        link={project.link}
                        image={project.image}
                        viewLink={project.viewLink}
                        color={project.color}
                        cardType="project"
                    />
                ))
            }
        </div>
    </div>

    <footer
        class="py-12 border-t border-white/5 w-full text-center text-gray-500 text-sm bg-black/50 backdrop-blur-sm"
    >
        <p>
            &copy; {new Date().getFullYear()} Mukund. Built with Astro & TailwindCSS.
        </p>
    </footer>
</Layout>
